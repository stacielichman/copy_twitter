# Сервис микроблогов Twitter-clone

Этот сервис позволяет публиковать короткие сообщения длиной до 280 символов, изображения или ссылки. 

Попробуйте использовать данный сервис: http://127.0.0.1:5000

## Особенности


### В данном сервисе пользователь может:

- добавить новый твит с картинкой / без картинки;
- удалить свой твит;
- подписаться на другого пользователя;
- отписаться от другого пользователя;
- отмечать твит как понравившийся;
- убрать отметку "Нравится";
- получить ленту из твитов, отсортированных в порядке убывания по популярности от пользователей, на которых он подписан;
- получить информацию о своём профиле;
- получить информацию о произвольном профиле;


## Инструкция по установке

### Предварительная подготовка
1. Установите на ПК интерпретатор языка программирования Python (версии 3.9 и новее).
2. Рекомендуем поставить виртуальное окружение в директории проекта: 

    ```python3 -m venv prod```
3. Активируйте виртуальное окружение:
    
    ```Windows:  prod\Scripts\activate```

    ```Linux / MacOS: source prod/bin/activate```
4. Установите необходимые библиотеки с помощью команды:

    ```pip install -r requirements.txt```
5. Соберите docker-container при помощи команды:

    ```docker-compose build```

### Настройка базы данных PostgreSQL
Для настройки базы данных укажите имя пользователя и пароль в файле **docker-compose.yml** 

Пример: 

POSTGRES_USER=admin 
POSTGRES_PASSWORD=admin


### Миграции
Миграции базы данных осуществляются при помощи инструмента Alembic. По умолчанию все миграции настроены для запуска. 
Однако, если вы произвели изменения в базе данных вам необходимо создать миграцию вручную.

Документация Alembic: https://alembic.sqlalchemy.org/en/latest/

### Запуск проекта
Чтобы запустить проект, введите в терминале команду 
```docker-compose up```

Чтобы запустить проект в фоновом режиме, введите в терминале команду
```docker-compose up -d```

А затем запустите модуль ```main.py```

### Тесты
Тесты написаны с использованием библиотеки pytest и faker 

Подробнее: https://docs.pytest.org/en/7.2.x/contents.html
https://faker.readthedocs.io/en/master/


#### Перед тем как начать тестирование необходимо:
1. Создайте виртуальное окружение под разработку в директории проекта:

    ```python3 -m venv dev```
2. Активируйте виртуальное окружение:
    
    ```Windows:  dev\Scripts\activate```

    ```Linux / MacOS: source dev/bin/activate```
3. Установите необходимые библиотеки с помощью команды:

    ```pip install -r requirements_dev.txt```
4. Перейдите в директорию /test

    ```cd test```
5. Запутите приложение

    ```docker-compose up```
6. В терминале вызовите команду 

    ```pytest```

### Документация
После установки и запуска проекта вся документация доступна по 
адресу http://127.0.0.1:5000/apidocs.

В документации представлены 9 функциональных запросов сервиса:

- POST /api/tweets - добавить новый твит;
- POST /api/medias - добавить медиафайл;
- DELETE /api/tweets/<id> - удалить твит;
- POST /api/users/<id>/follow - подписаться на другого пользователя;
- DELETE /api/users/<id>/follow - отписаться от другого пользователя;
- POST /api/tweets/<id>/likes - отметить твит как понравившийся;
- DELETE /api/tweets/<id>/likes - убрать отметку "Нравится";
- GET /api/tweets - получить ленту из твитов, отсортированных в порядке убывания по популярности от пользователей, на которых он подписан;
- GET /api/users/me - получить информацию о своём профиле;
- GET /api/users/<id> - получить информацию о произвольном профиле;
